<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spiral Ascension</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      background: radial-gradient(circle, #0b0010 0%, #1c0030 100%);
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .nav {
      display: flex;
      justify-content: space-around;
      background-color: #220044;
      padding: 10px;
      position: fixed;
      width: 100%;
      bottom: 0;
      z-index: 1000;
    }
    .nav button {
      background: #550088;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
    canvas {
      display: block;
      margin: 0 auto;
      margin-top: 20px;
      background-color: #1c0030;
      border: 2px solid #9900ff;
      border-radius: 12px;
    }
  </style>
</head>
<body>
  <h1>🌀 Spiral Ascension</h1>
  <canvas id="gameCanvas" width="400" height="800"></canvas>
  <div class="nav">
    <button onclick="switchPage('clicker')">Home</button>
    <button onclick="switchPage('shop')">Shop</button>
    <button onclick="switchPage('achievements')">Achievements</button>
    <button onclick="switchPage('rebirth')">Rebirth</button>
    <button onclick="switchPage('leaderboard')">Leaderboard</button>
  </div>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

let currentPage = "clicker";
    let clickAnimation = 0;

    function switchPage(page) {
      currentPage = page;
      drawUI();
      
      
    }

    let spirals = parseInt(localStorage.getItem("spirals")) || 0;
    let rebirths = parseInt(localStorage.getItem("rebirths")) || 0;
    let lastClickTime = 0;
    const clickCooldown = 300;
    const COOLDOWN_DURATION = 4 * 60 * 60 * 1000;

    let clicksLeft = parseInt(localStorage.getItem("clicksLeft")) || 500;
    let cooldownUntil = parseInt(localStorage.getItem("cooldownUntil")) || 0;
    const spiralImg = new Image();
    spiralImg.src = "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Archimedean_spiral.svg/240px-Archimedean_spiral.svg.png";

    function drawUI() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (currentPage === "clicker") {
        drawClicker();
      } else if (currentPage === "shop") {
        drawShop();
      } else if (currentPage === "achievements") {
        drawAchievementsPage();
      } else if (currentPage === "rebirth") {
        drawRebirthPage();
      } else if (currentPage === "leaderboard") {
        drawLeaderboardPage();
      }
    }

    function drawClicker() {
      const radius = 80 + Math.sin(clickAnimation) * 8;

      if (spiralImg.complete && spiralImg.naturalHeight !== 0) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(200, 240, radius, 0, Math.PI * 2);
        ctx.closePath();
        ctx.clip();
        ctx.drawImage(spiralImg, 200 - radius, 240 - radius, radius * 2, radius * 2);
        ctx.restore();
        if (Date.now() < cooldownUntil) {
          ctx.save();
          ctx.beginPath();
          ctx.arc(200, 240, radius + 5, 0, Math.PI * 2);
          ctx.strokeStyle = `rgba(255, 0, 100, ${0.5 + 0.5 * Math.sin(Date.now() / 300)})`;
          ctx.lineWidth = 4;
          ctx.stroke();
          ctx.restore();
        }
      } else {
        ctx.beginPath();
        ctx.arc(200, 240, radius, 0, Math.PI * 2);
        ctx.fillStyle = "#9900cc";
        ctx.fill();
        ctx.fillStyle = "#fff";
        ctx.font = "16px Arial";
        ctx.textAlign = "center";
        ctx.fillText("🌀", 200, 250);
      }

      ctx.fillStyle = "#fff";
      ctx.font = "18px Arial";
      ctx.textAlign = "center";
      ctx.fillText(`Spirals: ${spirals}`, 200, 440);
      ctx.fillText(`FEVCOIN: ${(spirals / 500).toFixed(2)}`, 200, 470);

      if (Date.now() < cooldownUntil) {
        const seconds = Math.floor((cooldownUntil - Date.now()) / 1000);
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        ctx.fillStyle = "#ff5555";
        ctx.fillText(`Cooldown: ${hours}h ${minutes}m ${secs}s`, 200, 500);
        // Cooldown bar
        const percent = 1 - ((cooldownUntil - Date.now()) / COOLDOWN_DURATION);
        ctx.fillStyle = "#9900ff";
        ctx.fillRect(100, 520, 200 * percent, 10);
        ctx.strokeStyle = "#ffffff";
        ctx.strokeRect(100, 520, 200, 10);
      } else {
        ctx.fillStyle = "#00ffcc";
        ctx.fillText(`Clicks Left: ${clicksLeft}`, 200, 500);
      }
    }

    canvas.addEventListener("click", function (e) {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const now = Date.now();
      if (currentPage !== "clicker") return;

      if (now < cooldownUntil) {
        alert("⏳ You're in cooldown. Wait before spiraling again.");
        return;
      }

      const dx = x - 200;
      const dy = y - 240;
      if (dx * dx + dy * dy < 80 * 80) {
        if (now - lastClickTime > clickCooldown) {
          if (clicksLeft <= 0) {
            cooldownUntil = now + COOLDOWN_DURATION;
            localStorage.setItem("cooldownUntil", cooldownUntil);
            clicksLeft = 0;
            alert("⚠️ You've reached the spiral limit. Cooldown started.");
            return;
          }
          spirals++;
          clicksLeft--;
          localStorage.setItem("spirals", spirals);
          localStorage.setItem("clicksLeft", clicksLeft);
          lastClickTime = now;
          clickAnimation = 5;
          
          drawUI();
        }
      }
    });

    function drawShop() {
      ctx.fillStyle = "#fff";
      ctx.font = "16px Arial";
      ctx.fillText("🛍 Spiral Booster Shop", 200, 150);

      ctx.font = "14px Arial";
      ctx.fillStyle = "#00ffcc";
      ctx.fillText("Buy +500 Clicks Booster", 200, 220);
      ctx.fillText("$1.99", 200, 240);
      ctx.strokeStyle = "#00ffcc";
      ctx.strokeRect(120, 200, 160, 50);

      ctx.fillStyle = "#ffcc00";
      ctx.fillText("Buy Cooldown Bypass", 200, 320);
      ctx.fillText("$2.99", 200, 340);
      ctx.strokeStyle = "#ffcc00";
      ctx.strokeRect(120, 300, 160, 50);

      canvas.addEventListener("click", handleShopClick);

      // Booster Buttons (Styled)
      ctx.fillStyle = "#222";
      ctx.fillRect(120, 200, 160, 50);
      ctx.fillStyle = "#00ffcc";
      ctx.font = "bold 14px Arial";
      ctx.fillText("+500 Clicks ($1.99)", 200, 230);
      ctx.strokeStyle = "#00ffcc";
      ctx.strokeRect(120, 200, 160, 50);

      ctx.fillStyle = "#222";
      ctx.fillRect(120, 300, 160, 50);
      ctx.fillStyle = "#ffcc00";
      ctx.fillText("Bypass Cooldown ($2.99)", 200, 330);
      ctx.strokeStyle = "#ffcc00";
      ctx.strokeRect(120, 300, 160, 50);
    }

    function drawAchievementsPage() {
      ctx.fillStyle = "#fff";
      ctx.font = "16px Arial";
      ctx.fillText("🎯 Achievements Coming Soon...", 200, 200);
    }

    function drawRebirthPage() {
      ctx.fillStyle = "#fff";
      ctx.font = "16px Arial";
      ctx.fillText("🔁 Rebirths: " + rebirths, 200, 200);
    }

    function handleShopClick(e) {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      if (currentPage !== "shop") return;

      // Buy +500 Clicks Booster
      if (x > 120 && x < 280 && y > 200 && y < 250) {
        if (confirm("Buy +500 Clicks for $1.99? (Simulated Purchase)")) {
          clicksLeft += 500;
          localStorage.setItem("clicksLeft", clicksLeft);
          
          alert("✅ You received +500 extra clicks!");
        }
      }

      // Bypass Cooldown
      if (x > 120 && x < 280 && y > 300 && y < 350) {
        if (confirm("Bypass Cooldown for $2.99? (Simulated Purchase)")) {
          cooldownUntil = 0;
          localStorage.setItem("cooldownUntil", cooldownUntil);
          
          alert("✅ Cooldown cleared!");
        }
      }
    }

function drawLeaderboardPage() {
      ctx.fillStyle = "#fff";
      ctx.font = "16px Arial";
      ctx.fillText("🏆 Leaderboard Coming Soon...", 200, 200);
    }

    function animate() {
      clickAnimation = Math.max(0, clickAnimation - 0.25);
      drawUI();
      requestAnimationFrame(animate);
    }

    spiralImg.onload = drawUI;
    window.onload = () => {
      const now = Date.now();
      if (now >= cooldownUntil) {
        clicksLeft = 500;
        cooldownUntil = 0;
        localStorage.setItem("clicksLeft", clicksLeft);
        localStorage.setItem("cooldownUntil", cooldownUntil);
      }
      drawUI();
      animate();
    };
  </script>
</body>
</html>
